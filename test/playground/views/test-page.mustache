<!DOCTYPE html>
<html>
<head>
    <title>Default playground test page</title>
    <!-- Microsoft Edge truncates the window title to the hostname if document.title contains only a URL. -->
    <!-- So, we need to add some characters before the URL in order to bring it to the window title.      -->
    <script>document.title = 'browser-id:' + document.location.toString()</script>
</head>
<body bgcolor="#f5f5dc">

<h1>This is a playground test page with id {{ id }}</h1>

<div>Client area size is <span id="client-area-size"></span></div>

<script type="text/javascript">
    var clientAreaSizeContainer = document.getElementById('client-area-size');

    function sendClientAreaSize (clientAreaSize) {
        var xhr = new XMLHttpRequest();

        xhr.open('POST', '/update-client-area-size/{{ id }}');
        xhr.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');
<<<<<<< Updated upstream
        xhr.send(JSON.stringify(clientAreaSize));
=======
        xhr.send(options.data || '{"xhr": true}');
    }

    function sendOpenConfirmation (callback) {
        sendXhr({ url: '/confirm-open/{{{ id }}}' }, callback);
    }

    function sendCloseConfirmation () {
        //if (navigator.sendBeacon)
        //    navigator.sendBeacon('/confirm-close/{{{ id }}}');
        //else
        sendXhr({ url: '/confirm-close/{{{ id }}}', sync: false });
    }

    function sendClientAreaSize (clientAreaSize, callback) {
        sendXhr({
            url:  '/update-client-area-size/{{ id }}',
            data: JSON.stringify(clientAreaSize)
        }, callback);
>>>>>>> Stashed changes
    }

    function updateClientAreaSize () {
        var clientAreaSize = {
            width:  window.innerWidth,
            height: window.innerHeight
        };

        clientAreaSizeContainer.textContent =  clientAreaSize.width + 'x' + clientAreaSize.height;

        sendClientAreaSize(clientAreaSize);
    }

    updateClientAreaSize();

    window.addEventListener('resize', updateClientAreaSize);
<<<<<<< Updated upstream
=======
    window.addEventListener('beforeunload', function (e) {
        sendCloseConfirmation();
        e.preventDefault();
        e.returnValue = 'test';
        return 'test';
    });
>>>>>>> Stashed changes
</script>
</body>
</html>
